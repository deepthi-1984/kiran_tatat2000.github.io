<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K2QGFTBD');</script>
<!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <title>Product Detail</title>

  
</head>

<body>
  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K2QGFTBD"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <h1>Product Detail</h1>

  <p id="product-name">Sample Product</p>
  <p>Price: $499</p>

  <button id="add-to-cart">Add to Cart</button>
  <br><br>
  <a href="cart.html">Go to Cart</a>
<nav>
        <a href="index.html">Home</a> |
        <a href="products.html">View Products</a> |
        <a href="products-detail.html">Product Detail</a> |
        <a href="cart.html">Cart</a> |
        <a href="checkout.html">Checkout</a> |
        <a href="about.html">About</a>
    </nav>
  <hr>
  <script>
    function getProductId() {
      const params = new URLSearchParams(window.location.search);
      return params.get('product_id');
    }

    const productId = getProductId() || 'unknown_id';
    const productName = document.getElementById("product-name").innerText;

    // Or better, check if it exists before firing the event
  if (productId) {
    gtag('event', 'view_item', {
      currency: 'USD',
      value: 499,
      items: [{
        item_id: productId,
        item_name: productName,
        price: 499
      }]
    });
}

    // Fire view_item AFTER everything exists
    gtag('event', 'view_item', {
      currency: 'USD',
      value: 499,
      items: [{
        item_id: productId,
        item_name: productName,
        price: 499
      }]
    });

    document.getElementById("add-to-cart").addEventListener("click", function () {
      gtag('event', 'add_to_cart', {
        currency: 'USD',
        value: 499,
        items: [{
          item_id: productId,
          item_name: productName,
          price: 499
        }]
      });
    });
  </script>
</body>
</html>

